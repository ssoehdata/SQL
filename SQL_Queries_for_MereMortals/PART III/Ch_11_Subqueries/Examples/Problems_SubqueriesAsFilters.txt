-- problems within the text (not the end of chapter problems)

SELECT Customers.CustomerID, Customers.CustFirstName, Customers.CustLastName
FROM Customers
WHERE Customers.CustomerID IN 
(SELECT Orders.CustomerID FROM ((Orders 
INNER JOIN Order_Details
ON Orders.OrderNumber = Order_Details.OrderNumber) 
INNER JOIN Products
ON Products.ProductNumber = Order_Details.ProductNumber) 
INNER JOIN Categories
ON Categories.CategoryID = Products.CategoryID 
WHERE Categories.CategoryDescription = 'Bikes');



--"Display customers who ordered clothing or accessories (use either 'SOME' or 'ANY')"

-- Notes: For "SOME' or 'ANY' the predicate is true if the value expression on the left Does NOT
-- equal at least one of the values in the list. 

	
SELECT  CustomerID, CustFirstName, CustLastName
FROM  Customers
WHERE  (CustomerID = SOME
     (SELECT Orders.CustomerID
      FROM ((Orders INNER JOIN Order_Details
            ON Orders.OrderNumber = Order_Details.OrderNumber) 
			INNER JOIN Products 
            ON Products.ProductNumber = Order_Details.ProductNumber) 
			INNER JOIN Categories
            ON Categories.CategoryID = Products.CategoryID
               WHERE  Categories.CategoryDescription = 'Clothing' 
			   OR  Categories.CategoryDescription = 'Accessories'));

--------------------------------------------------------------------------------------


--"Find all customers who ordered a bicycle helmet (IN)"

SELECT CustomerID, CustFirstName, CustLastName 
FROM Customers 
WHERE Customers.CustomerID IN 
(SELECT Orders.CustomerID FROM ((Orders 
INNER JOIN Order_Details
ON Orders.OrderNumber = Order_Details.OrderNumber) 
INNER JOIN Products
ON Products.ProductNumber = Order_Details.ProductNumber) 
INNER JOIN Categories
ON Categories.CategoryID = Products.CategoryID 
WHERE Categories.CategoryDescription LIKE '%helmet%'); 

----------------------------------------------------------


--  What products have never been ordered? (NOT IN)

SELECT Products.ProductName
FROM Products
WHERE Products.ProductNumber 
NOT IN (SELECT Order_Details.ProductNumber
		FROM Order_Details);

--- 

-- "List customers who have booked entertainers who play country or country rock (IN)"


SELECT Customers.CustomerID, Customers.CustFirstName, Customers.CustLastName 
FROM Customers  
WHERE Customers.CustomerID IN 
(SELECT Engagements.CustomerID
FROM ((Musical_Styles
INNER JOIN Entertainer_Styles
ON Musical_Styles.StyleID = Entertainer_Styles.StyleID)
INNER JOIN Entertainers
ON Entertainers.EntertainerID = Entertainer_Styles.EntertainerID)
INNER JOIN Engagements
ON Entertainers.EntertainerID = Engagements.EntertainerID
WHERE Musical_Styles.StyleName = 'Country'
OR Musical_Styles.StyleName = 'Country Rock');

----------------------------------------------------------------------------
-- (Example below includes notes)

--"Find the entertainers who played engagements for customers Bonnicksen or Rosales." (SOME)

-- We are looking for the entertainers who played for either of these two customers.

-- (Notation: "[]" represent steps in prob solving process)

-- [] relevant tables required : Entertainers, Engagements,Customers

-- -- []  get entertainer names (Entertainers table will suffice)
SELECT Entertainers.EntertainerID, Entertainers.EntStageName
FROM Entertainers
-- [] engagements for customers Bonnicksen OR Rosales (will need Engagements & Customers Tables)
--  filtering with SOME for cases EntertainerID is found in the subquery to be defined
-- remember for SOME, ANY, only one value need be true. For ALL, all comparisons must be true for all 
-- values 
WHERE Entertainers.EntertainerID = SOME

-- [] subquery to find engagments based on customer names(join Engagements and Customers Tables)
-- create subquery filter joining the two tables
(SELECT Engagements.EntertainerID
FROM Customers
INNER JOIN Engagements 
ON Customers.CustomerID = Engagements.CustomerID
-- [] filter with  WHERE clause  and OR to find customer names of interest
WHERE Customers.CustLastName='Bonnicksen' 
OR Customers.CustLastName='Rosales')
;

-- without the notes: 

SELECT Entertainers.EntStageName, Entertainers.EntertainerID
FROM Entertainers

WHERE Entertainers.EntertainerID = SOME 
(SELECT Engagements.EntertainerID
FROM Customers 
INNER JOIN Engagements
ON Customers.CustomerID = Engagements.CustomerID

WHERE Customers.CustLastName = 'Bonnicksen'
OR 
Customers.CustLastName = 'Rosales')
;

-------------------------------------------------------------


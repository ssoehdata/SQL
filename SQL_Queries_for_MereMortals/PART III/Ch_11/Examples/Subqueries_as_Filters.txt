-- List customers and all the details from their last order 

SELECT Customers.CustFirstName, Customers.CustLastName, 
Orders.OrderDate, Order_Details.ProductNumber,
Products.ProductName,
Order_Details.QuantityOrdered
FROM ((Customers
INNER JOIN Orders 
	ON Customers.CustomerID = Orders.CustomerID)
 INNER JOIN Order_Details
 	ON Orders.OrderNumber = Order_Details.OrderNumber)
 INNER JOIN Products
 	ON Products.ProductNumber = Order_Details.ProductNumber
WHERE Orders.OrderDate = 
	(SELECT MAX (OrderDate)
	FROM Orders AS O2 
	WHERE O2.CustomerId = Customers.CustomerID)
;


-- another solution 

SELECT RecipeTitle
FROM Recipes
WHERE Recipes.RecipeID IN 
	(SELECT RecipeID 
	FROM (Recipe_Ingredients
	INNER JOIN Ingredients 
		ON Recipe_Ingredients.IngredientID = 
			Ingredients.IngredientID)
	INNER JOIN Ingredient_Classes
		ON Ingredients.IngredientClassID =
		   Ingredient_Classes.IngredientClassID
		  WHERE
		  Ingredient_Classes.IngredientClassDescription = 'Seafood')



-- This version however could produce duplicate rows 
--	(The Recipes_Ingredients table might have many rows for each row in the Recipes table)

SELECT RecipeTitle
FROM ((Recipes
INNER JOIN Recipe_Ingredients
	ON Recipes.RecipeID = Recipe_Ingredients.RecipeID)
INNER JOIN Ingredients
	ON Recipe_Ingredients.IngredientID = 
		Ingredients.IngredientID)
INNER JOIN Ingredient_Classes 
	ON Ingredients.IngredientClassID = 
	Ingredient_Classes.IngredientClassID
WHERE 
Ingredient_Classes.IngredientClassDescription = 'Seafood'
;

